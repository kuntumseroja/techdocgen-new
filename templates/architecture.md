{# Architecture-centric Documentation Template #}
{# This template generates domain-driven documentation organized by architectural concerns #}
{# It's flexible and uses doc_structure configuration for section definitions #}

{% set doc_title = (doc_structure.title if doc_structure is defined and doc_structure.title) or "Architecture and System Overview" %}
{% set show_toc = (doc_structure.show_toc if doc_structure is defined and doc_structure.show_toc is not none) | default(true) %}

# {{ doc_title }}

**Generated by:** TechDocGen by IBMC  
**Model Use:** {% if llm_provider == 'ollama' %}local {% endif %}{{ model_name }}  
**Generation Date:** {{ generation_date }}

---

{% if doc_structure.intro %}
{{ doc_structure.intro }}

---
{% endif %}

{% if show_toc %}
## Table of Contents

{% for section in doc_structure.sections %}
- [{{ section.title }}](#{{ section.title | lower | replace(' ', '-') | replace('(', '') | replace(')', '') | replace('+', '') }})
{% if section.subsections %}
{% for subsection in section.subsections %}
  - [{{ subsection.title }}](#{{ subsection.title | lower | replace(' ', '-') | replace('(', '') | replace(')', '') | replace('+', '') }})
{% endfor %}
{% endif %}
{% endfor %}

{% if show_file_reference | default(true) %}
- [Source Files Reference](#source-files-reference)
{% endif %}
{% endif %}

---

{% for section in doc_structure.sections %}
# {{ section.title }}

{% if section.description %}
{{ section.description }}

{% endif %}
{% if section.content %}
{{ section.content }}

{% endif %}

{% if section.subsections %}
{% for subsection in section.subsections %}
## {{ subsection.title }}

{% if subsection.content %}
{{ subsection.content }}

{% endif %}

{% endfor %}
{% endif %}

---

{% endfor %}

{% if show_file_reference | default(true) %}
# Source Files Reference

{% if service_catalog %}
{% if service_catalog.controllers %}
## Controllers

{% for ctrl in service_catalog.controllers %}
- `{{ ctrl.name }}`{% if ctrl.route %} (Route: `{{ ctrl.route }}`){% endif %}
{% endfor %}

{% endif %}

{% if service_catalog.endpoints %}
## API Endpoints

| Controller | Method | HTTP | Route |
|------------|--------|------|-------|
{% for ep in service_catalog.endpoints %}
| `{{ ep.controller }}` | `{{ ep.method }}` | {{ ep.http_verbs|join(', ') }} | `{{ ep.route }}` |
{% endfor %}

{% endif %}

{% if service_catalog.services %}
## Services / Repositories

{{ service_catalog.services|join(', ') }}

{% endif %}

{% if service_catalog.interfaces %}
## Interfaces

{{ service_catalog.interfaces|join(', ') }}

{% endif %}
{% endif %}

{% if messaging_flows %}
## Messaging Flows

{% for flow in messaging_flows %}
- Queue `{{ flow.queue }}`{% if flow.consumers %} â†’ Consumers: {{ flow.consumers|join(', ') }}{% endif %}{% if flow.sagas %}; Sagas: {{ flow.sagas|join(', ') }}{% endif %} {% if flow.file %}(`{{ flow.file }}`){% endif %}
{% endfor %}

{% endif %}

{% if integration_graph and integration_graph|trim %}
## Integration Graph

{{ integration_graph }}

{% endif %}

{% if app_sequence_diagram and app_sequence_diagram|trim %}
## Application Sequence Diagram

{{ app_sequence_diagram }}

{% endif %}

## File Inventory

{% for language, files in files_by_language.items() %}
{% if language != "unknown" %}
### {{ language|upper }} Files ({{ files|length }})

{% for file_info in files %}
- `{{ file_info.relative_path or file_info.path }}`
{% endfor %}

{% endif %}
{% endfor %}
{% endif %}

---

*This documentation was automatically generated by TechDocGen. For questions or updates, please contact the development team.*
